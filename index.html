<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>eBuy Marketplace</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
    </style>
</head>
<body class="bg-gray-50">
    <div id="app"></div>

    <script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>
    
    <script type="text/babel">
        const { useState, useEffect } = React;

        const Icon = ({ type, size = 24, className = "" }) => {
            const icons = {
                search: <svg className={className} width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/></svg>,
                cart: <svg className={className} width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><circle cx="9" cy="21" r="1"/><circle cx="20" cy="21" r="1"/><path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"/></svg>,
                heart: <svg className={className} width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/></svg>,
                user: <svg className={className} width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>,
                trending: <svg className={className} width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><polyline points="23 6 13.5 15.5 8.5 10.5 1 18"/><polyline points="17 6 23 6 23 12"/></svg>,
                clock: <svg className={className} width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>,
                star: <svg className={className} width={size} height={size} viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" strokeWidth="2"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg>
            };
            return icons[type] || null;
        };

        const EbayMarketplace = () => {
            const [searchTerm, setSearchTerm] = useState('');
            const [viewHistory, setViewHistory] = useState([]);
            const [cart, setCart] = useState([]);
            const [selectedCategory, setSelectedCategory] = useState('all');

            const products = [
                { id: 1, name: 'Vintage Camera', price: 299, category: 'electronics', image: 'ðŸ“·', views: 0, condition: 'Used' },
                { id: 2, name: 'Designer Handbag', price: 850, category: 'fashion', image: 'ðŸ‘œ', views: 0, condition: 'New' },
                { id: 3, name: 'Gaming Laptop', price: 1299, category: 'electronics', image: 'ðŸ’»', views: 0, condition: 'Refurbished' },
                { id: 4, name: 'Leather Jacket', price: 450, category: 'fashion', image: 'ðŸ§¥', views: 0, condition: 'Used' },
                { id: 5, name: 'Smartphone', price: 699, category: 'electronics', image: 'ðŸ“±', views: 0, condition: 'New' },
                { id: 6, name: 'Running Shoes', price: 120, category: 'sports', image: 'ðŸ‘Ÿ', views: 0, condition: 'New' },
                { id: 7, name: 'Mechanical Keyboard', price: 180, category: 'electronics', image: 'âŒ¨ï¸', views: 0, condition: 'New' },
                { id: 8, name: 'Yoga Mat', price: 45, category: 'sports', image: 'ðŸ§˜', views: 0, condition: 'New' },
                { id: 9, name: 'Sunglasses', price: 220, category: 'fashion', image: 'ðŸ•¶ï¸', views: 0, condition: 'New' },
                { id: 10, name: 'Wireless Headphones', price: 280, category: 'electronics', image: 'ðŸŽ§', views: 0, condition: 'New' },
                { id: 11, name: 'Watch', price: 550, category: 'fashion', image: 'âŒš', views: 0, condition: 'Used' },
                { id: 12, name: 'Bicycle', price: 890, category: 'sports', image: 'ðŸš´', views: 0, condition: 'Used' },
            ];

            const ads = [
                { id: 'ad1', name: 'Premium Camera Lenses', price: 399, category: 'electronics', image: 'ðŸ“¸', targetCategories: ['electronics'] },
                { id: 'ad2', name: 'Designer Wallet', price: 250, category: 'fashion', image: 'ðŸ‘›', targetCategories: ['fashion'] },
                { id: 'ad3', name: 'Gaming Mouse', price: 89, category: 'electronics', image: 'ðŸ–±ï¸', targetCategories: ['electronics'] },
                { id: 'ad4', name: 'Fitness Tracker', price: 199, category: 'sports', image: 'âŒš', targetCategories: ['sports', 'electronics'] },
                { id: 'ad5', name: 'Luxury Perfume', price: 150, category: 'fashion', image: 'ðŸ’', targetCategories: ['fashion'] },
            ];

            const handleProductView = (product) => {
                const newHistory = [...viewHistory, { ...product, timestamp: Date.now() }];
                setViewHistory(newHistory.slice(-10));
            };

            const getPersonalizedAds = () => {
                if (viewHistory.length === 0) {
                    return ads.slice(0, 2);
                }

                const categoryCount = {};
                viewHistory.forEach(item => {
                    categoryCount[item.category] = (categoryCount[item.category] || 0) + 1;
                });

                const sortedCategories = Object.entries(categoryCount)
                    .sort((a, b) => b[1] - a[1])
                    .map(([cat]) => cat);

                const relevantAds = ads.filter(ad => 
                    ad.targetCategories.some(cat => sortedCategories.includes(cat))
                );

                return relevantAds.length > 0 ? relevantAds.slice(0, 2) : ads.slice(0, 2);
            };

            const filteredProducts = products.filter(p => 
                (selectedCategory === 'all' || p.category === selectedCategory) &&
                (searchTerm === '' || p.name.toLowerCase().includes(searchTerm.toLowerCase()))
            );

            const personalizedAds = getPersonalizedAds();

            return (
                <div className="min-h-screen bg-gray-50">
                    <header className="bg-white shadow-sm border-b">
                        <div className="max-w-7xl mx-auto px-4 py-4">
                            <div className="flex items-center justify-between mb-4">
                                <h1 className="text-3xl font-bold text-blue-600">eBuy</h1>
                                <div className="flex gap-4">
                                    <button className="p-2 hover:bg-gray-100 rounded-full">
                                        <Icon type="heart" />
                                    </button>
                                    <button className="p-2 hover:bg-gray-100 rounded-full relative">
                                        <Icon type="cart" />
                                        {cart.length > 0 && (
                                            <span className="absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center">
                                                {cart.length}
                                            </span>
                                        )}
                                    </button>
                                    <button className="p-2 hover:bg-gray-100 rounded-full">
                                        <Icon type="user" />
                                    </button>
                                </div>
                            </div>
                            
                            <div className="flex gap-2">
                                <div className="flex-1 relative">
                                    <div className="absolute left-3 top-3 text-gray-400">
                                        <Icon type="search" size={20} />
                                    </div>
                                    <input
                                        type="text"
                                        placeholder="Search for anything"
                                        className="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-500"
                                        value={searchTerm}
                                        onChange={(e) => setSearchTerm(e.target.value)}
                                    />
                                </div>
                                <button className="px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700">
                                    Search
                                </button>
                            </div>
                        </div>
                    </header>

                    <div className="max-w-7xl mx-auto px-4 py-6">
                        <div className="flex gap-2 mb-6 overflow-x-auto pb-2">
                            {['all', 'electronics', 'fashion', 'sports'].map(cat => (
                                <button
                                    key={cat}
                                    onClick={() => setSelectedCategory(cat)}
                                    className={`px-4 py-2 rounded-full whitespace-nowrap ${
                                        selectedCategory === cat
                                            ? 'bg-blue-600 text-white'
                                            : 'bg-white border hover:border-blue-500'
                                    }`}
                                >
                                    {cat.charAt(0).toUpperCase() + cat.slice(1)}
                                </button>
                            ))}
                        </div>

                        {viewHistory.length > 0 && (
                            <div className="mb-8 bg-gradient-to-r from-purple-50 to-blue-50 rounded-lg p-6 border-2 border-purple-200">
                                <div className="flex items-center gap-2 mb-4">
                                    <Icon type="trending" className="text-purple-600" />
                                    <h2 className="text-xl font-bold text-gray-800">
                                        Recommended For You
                                    </h2>
                                    <span className="text-sm text-gray-600 ml-2">
                                        (Based on your browsing history)
                                    </span>
                                </div>
                                <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    {personalizedAds.map(ad => (
                                        <div key={ad.id} className="bg-white rounded-lg shadow-md p-4 border-2 border-purple-300 hover:shadow-lg transition-shadow">
                                            <div className="flex items-start gap-4">
                                                <div className="text-6xl">{ad.image}</div>
                                                <div className="flex-1">
                                                    <div className="flex items-center gap-2 mb-1">
                                                        <span className="bg-purple-100 text-purple-700 text-xs px-2 py-1 rounded">
                                                            SPONSORED
                                                        </span>
                                                    </div>
                                                    <h3 className="font-semibold text-lg mb-1">{ad.name}</h3>
                                                    <p className="text-2xl font-bold text-blue-600 mb-2">
                                                        ${ad.price}
                                                    </p>
                                                    <button className="w-full bg-purple-600 text-white py-2 rounded-lg hover:bg-purple-700 transition-colors">
                                                        View Item
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        )}

                        {viewHistory.length > 0 && (
                            <div className="mb-6 bg-white rounded-lg p-4 shadow">
                                <div className="flex items-center gap-2 mb-3">
                                    <Icon type="clock" size={20} className="text-gray-600" />
                                    <h3 className="font-semibold text-gray-800">Recently Viewed</h3>
                                </div>
                                <div className="flex gap-3 overflow-x-auto pb-2">
                                    {viewHistory.slice(-5).reverse().map((item, idx) => (
                                        <div key={idx} className="flex flex-col items-center min-w-[80px]">
                                            <div className="text-3xl mb-1">{item.image}</div>
                                            <span className="text-xs text-gray-600 text-center">{item.name}</span>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        )}

                        <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
                            {filteredProducts.map(product => (
                                <div
                                    key={product.id}
                                    className="bg-white rounded-lg shadow hover:shadow-lg transition-shadow p-4 cursor-pointer"
                                    onClick={() => handleProductView(product)}
                                >
                                    <div className="text-6xl mb-3 text-center">{product.image}</div>
                                    <h3 className="font-semibold mb-2 text-sm">{product.name}</h3>
                                    <div className="flex items-center gap-1 mb-2">
                                        <Icon type="star" size={14} className="text-yellow-400" />
                                        <span className="text-xs text-gray-600">4.5 (234)</span>
                                    </div>
                                    <div className="flex items-center justify-between mb-2">
                                        <p className="text-xl font-bold text-blue-600">${product.price}</p>
                                        <span className="text-xs bg-gray-100 px-2 py-1 rounded">
                                            {product.condition}
                                        </span>
                                    </div>
                                    <button
                                        onClick={(e) => {
                                            e.stopPropagation();
                                            setCart([...cart, product]);
                                        }}
                                        className="w-full bg-blue-600 text-white py-2 rounded-lg hover:bg-blue-700 transition-colors text-sm"
                                    >
                                        Add to Cart
                                    </button>
                                </div>
                            ))}
                        </div>
